exports.ls = function(task, command, params){
    ObjC.import('Foundation');
    var fileManager = $.NSFileManager.defaultManager;
    var attributes = ObjC.deepUnwrap(fileManager.attributesOfItemAtPathError($(params), $()));
    if(attributes != undefined){
        if(attributes.hasOwnProperty('NSFileType') && attributes['NSFileType'] == "NSFileTypeDirectory"){
            var error = Ref();
            var files = fileManager.contentsOfDirectoryAtPathError($(params), error);
            if(error[0].js == $().js){
                attributes['files'] = ObjC.deepUnwrap(files);
            }
        }
        return JSON.stringify(attributes, null, 2);
    }
    return "Failed to get attributes of file";
};