{% extends "base.html" %}
{% block body %}

<h1>
    Payload Management
</h1>
<div style="resize: vertical; overflow:scroll" class="panel panel-primary" id="payloads_table" >
    <div class="panel-heading">Current Payload Information</div>
        <table class="table table-striped table-hover table-condensed well-sm" >
            <tr>
                <td><b>Delete</b></td>
                <td><b>UUID</b></td>
                <td><b>Tag</b></td>
                <td><b>Creator</b></td>
                <td><b>Creation Time</b></td>
                <td><b>Payload Type</b></td>
                <td><b>Host:Port (Interval)</b></td>
                <td><b>C2 Profile</b></td>
                <td><b>Location</b></td>
            </tr>
        <!-- Repeat this for each web service -->
            <tr v-for="p in payloads" :key="p.creation_time" v-show="show_autogenerated || !p.location.includes('/payloads/operations/')">
                <td>
                    <button type="button" class="btn btn-danger btn-sm" @click="delete_button(p)" >Delete</button>
                </td>
                <td>
			        <button type="button" class="btn btn-info btn-sm" @click="show_uuid_button(p)">UUID</button>
		        </td>
                <td>[[ p.tag ]]</td>
                <td>[[ p.operator ]]</td>
                <td>[[ p.creation_time ]]</td>
                <td>[[ p.payload_type ]]</td>
                <td>[[ p.callback_host]]:[[p.callback_port]]([[ p.callback_interval ]])</td>
                <td>[[ p.c2_profile ]]</td>
                <td>
                    <div v-if="p.location.includes('/payloads/operations/')">
                        [[ p.location.substring(p.location.indexOf('operations')) ]]
                    </div>
                    <div v-else>
                        [[ p.location ]]
                    </div>
                </td>
            </tr>
        <!-- End of the repeating -->
        </table>
</div>
<!-- THIS IS OUR MODAL FOR DELETING PAYLOAD -->
<div class="modal fade bs-example-modal-sm" id="payloadDeleteModal" role="dialog">
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">Ã—</button>
                <h3 id="modalLabel">Are you sure? This could have implications elsewhere.</h3>
                Remove the specified payload from the database (and optionally from disk).
            </div>
              <div class="modal-body" id="payloadDeleteBody">
                  <h4>Delete from disk:&nbsp;&nbsp;<input type="checkbox" id="payloadDeleteFile"></h4>
              </div>
              <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
                <button class="btn btn-primary" data-dismiss="modal" id="payloadDeleteSubmit">Submit</button>
              </div>
        </div>
    </div>
</div>
<button type="button" class="btn btn-info btn-md" onclick="toggle_all_button()">Toggle Autogenerated</button>
<!-- END MODAL FOR DELETING PAYLOAD -->
{% endblock %}

{% block scripts %}
{% include "payload_management.js" %}
{% include "shared_javascript.js" %}
{% endblock %}
